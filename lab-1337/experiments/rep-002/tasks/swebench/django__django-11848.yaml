id: django__django-11848
prompt: "django.utils.http.parse_http_date two digit year check is incorrect\nDescription\n\
  \t \n\t\t(last modified by Ad Timmering)\n\t \nRFC 850 does not mention this, but\
  \ in RFC 7231 (and there's something similar in RFC 2822), there's the following\
  \ quote:\nRecipients of a timestamp value in rfc850-date format, which uses a\n\
  two-digit year, MUST interpret a timestamp that appears to be more\nthan 50 years\
  \ in the future as representing the most recent year in\nthe past that had the same\
  \ last two digits.\nCurrent logic is hard coded to consider 0-69 to be in 2000-2069,\
  \ and 70-99 to be 1970-1999, instead of comparing versus the current year.\n"
repo: django/django
base_commit: f0adf3b9b7a19cdee05368ff0c0c2d087f011180
fail_to_pass:
- '["test_parsing_rfc850 (utils_tests.test_http.HttpDateProcessingTests)", "test_parsing_year_less_than_70
  (utils_tests.test_http.HttpDateProcessingTests)"]'
pass_to_pass:
- '["test_input_too_large (utils_tests.test_http.Base36IntTests)", "test_invalid_literal
  (utils_tests.test_http.Base36IntTests)", "test_negative_input (utils_tests.test_http.Base36IntTests)",
  "test_roundtrip (utils_tests.test_http.Base36IntTests)", "test_to_base36_errors
  (utils_tests.test_http.Base36IntTests)", "test_to_int_errors (utils_tests.test_http.Base36IntTests)",
  "test_values (utils_tests.test_http.Base36IntTests)", "test (utils_tests.test_http.EscapeLeadingSlashesTests)",
  "test_quote (utils_tests.test_http.URLQuoteTests)", "test_quote_plus (utils_tests.test_http.URLQuoteTests)",
  "test_unquote (utils_tests.test_http.URLQuoteTests)", "test_unquote_plus (utils_tests.test_http.URLQuoteTests)",
  "test_parsing (utils_tests.test_http.ETagProcessingTests)", "test_quoting (utils_tests.test_http.ETagProcessingTests)",
  "test_allowed_hosts_str (utils_tests.test_http.IsSafeURLTests)", "test_bad_urls
  (utils_tests.test_http.IsSafeURLTests)", "test_basic_auth (utils_tests.test_http.IsSafeURLTests)",
  "test_good_urls (utils_tests.test_http.IsSafeURLTests)", "test_is_safe_url_deprecated
  (utils_tests.test_http.IsSafeURLTests)", "test_no_allowed_hosts (utils_tests.test_http.IsSafeURLTests)",
  "test_secure_param_https_urls (utils_tests.test_http.IsSafeURLTests)", "test_secure_param_non_https_urls
  (utils_tests.test_http.IsSafeURLTests)", "test_bad (utils_tests.test_http.IsSameDomainTests)",
  "test_good (utils_tests.test_http.IsSameDomainTests)", "test_roundtrip (utils_tests.test_http.URLSafeBase64Tests)",
  "test_http_date (utils_tests.test_http.HttpDateProcessingTests)", "test_parsing_asctime
  (utils_tests.test_http.HttpDateProcessingTests)", "test_parsing_rfc1123 (utils_tests.test_http.HttpDateProcessingTests)",
  "test_custom_iterable_not_doseq (utils_tests.test_http.URLEncodeTests)", "test_dict
  (utils_tests.test_http.URLEncodeTests)", "test_dict_containing_empty_sequence_doseq
  (utils_tests.test_http.URLEncodeTests)", "test_dict_containing_sequence_doseq (utils_tests.test_http.URLEncodeTests)",
  "test_dict_containing_sequence_not_doseq (utils_tests.test_http.URLEncodeTests)",
  "test_dict_containing_tuple_not_doseq (utils_tests.test_http.URLEncodeTests)", "test_dict_with_bytearray
  (utils_tests.test_http.URLEncodeTests)", "test_dict_with_bytes_values (utils_tests.test_http.URLEncodeTests)",
  "test_dict_with_sequence_of_bytes (utils_tests.test_http.URLEncodeTests)", "test_generator
  (utils_tests.test_http.URLEncodeTests)", "test_multivaluedict (utils_tests.test_http.URLEncodeTests)",
  "test_none (utils_tests.test_http.URLEncodeTests)", "test_none_in_generator (utils_tests.test_http.URLEncodeTests)",
  "test_none_in_sequence (utils_tests.test_http.URLEncodeTests)", "test_tuples (utils_tests.test_http.URLEncodeTests)"]'
difficulty: 15 min - 1 hour
hints: 'Accepted, however I don''t think your patch is correct. The check should be
  relative to the current year, if I read the RFC quote correctly.

  Created a pull request: Created a pull request: â€‹https://github.com/django/django/pull/9214

  Still some suggested edits on the PR.

  I added regression test that fails with old code (test_parsing_rfc850_year_69),
  updated commit message to hopefully follow the guidelines, and added additional
  comments about the change. Squashed commits as well. Could you review the pull request
  again?

  sent new pull request

  This is awaiting for changes from Tim''s feedback on PR. (Please uncheck "Patch
  needs improvement" again when that''s done. ðŸ™‚)

  As this issue hasn''t received any updates in the last 8 months, may I work on this
  ticket?

  Go for it, I don''t think I will have time to finish it.

  Thanks, I''ll pick up from where you left off in the PR and make the recommended
  changes on a new PR.

  Tameesh Biswas Are you working on this ?

  Yes, I am.

  I''ve just picked up from the previous PR and opened a new PR here: â€‹https://github.com/django/django/pull/10749
  It adds regression tests in the first commit that pass without applying the fix
  and adds the fix with another test-case that only passes with the fix applied. Could
  you please review the changes?

  Tameesh, I left a comment on the PR regarding the use of non-UTC today.

  As an issue haven''t received an update for 4 months, I''m taking it over (djangocon
  europe 2019 sprint day 1).

  Created new PR: â€‹https://github.com/django/django/pull/11212

  I think an earlier comment by Simon Charette (about using a fixed year in the tests)
  still applies to the new PR; I''ve added it.

  Taking the liberty to reassign due to inactivity (6 months) and adding a pull request
  with revised code and addressing feedback on prior PRs. Please add give your comments
  for any concerns:) PR => â€‹https://github.com/django/django/pull/11848 Year is now
  checked in relation to current year, rolling over to the past if more than 50 years
  in the future Test now uses a patched version of datetime.datetime to pin to a specific
  year and have static test cases, addressing feedback from charettes@ on PR 10749
  in Dec 2018.'
