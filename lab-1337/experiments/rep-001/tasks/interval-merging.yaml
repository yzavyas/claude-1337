name: interval-merging
description: |
  Merge overlapping intervals - a LeetCode medium problem with many edge cases.
  Tests sorting, adjacent handling, containment, negative numbers.

function_name: merge_intervals

prompt: |
  Write a Python function that merges overlapping intervals.

  Requirements:
  - Function name: merge_intervals
  - Takes a list of intervals, where each interval is [start, end]
  - Returns a list of merged, non-overlapping intervals sorted by start
  - Adjacent intervals that touch should be merged (e.g., [1,2] and [2,3] become [1,3])
  - Handle empty input (return empty list)
  - Handle unsorted input (sort first)
  - Handle negative numbers

  Examples:
  - merge_intervals([[1,3],[2,6],[8,10],[15,18]]) -> [[1,6],[8,10],[15,18]]
  - merge_intervals([[1,4],[4,5]]) -> [[1,5]]
  - merge_intervals([]) -> []

  Provide ONLY the Python function, no tests or examples.

review_prompt: |
  Review your implementation above carefully. Check for these common bugs:

  1. Does it sort the intervals first? (unsorted input is valid)
  2. Does it handle adjacent intervals correctly? ([1,2] and [2,3] should merge to [1,3])
  3. Does it handle empty input? (should return [])
  4. Does it handle negative numbers?
  5. Does it handle when one interval contains another? ([[1,4],[2,3]] -> [[1,4]])
  6. Does it mutate the input or create a new list?

  Think through edge cases:
  - [[4,5],[1,4],[0,1]] (unsorted, all should merge to [0,5])
  - [[-5,-1],[-3,2],[3,5]] (negative numbers)
  - [[1,3],[1,3]] (identical intervals)

  If you find any issues, provide a CORRECTED implementation.
  If the implementation handles all cases correctly, respond with "IMPLEMENTATION VERIFIED" and the code.

test_cases:
  # Basic cases
  - input: [[1, 3], [2, 6], [8, 10], [15, 18]]
    expected: [[1, 6], [8, 10], [15, 18]]
    description: Standard overlap

  - input: [[1, 4], [4, 5]]
    expected: [[1, 5]]
    description: Adjacent intervals (touching)

  - input: [[1, 4], [0, 4]]
    expected: [[0, 4]]
    description: Complete overlap

  # Edge cases - where single-shot often fails
  - input: []
    expected: []
    description: Empty input

  - input: [[1, 1]]
    expected: [[1, 1]]
    description: Single point interval

  - input: [[1, 5]]
    expected: [[1, 5]]
    description: Single interval

  - input: [[1, 4], [2, 3]]
    expected: [[1, 4]]
    description: One interval contains another

  - input: [[1, 4], [0, 0]]
    expected: [[0, 0], [1, 4]]
    description: Non-overlapping point before

  # Unsorted input - common failure point
  - input: [[3, 4], [1, 2], [5, 6]]
    expected: [[1, 2], [3, 4], [5, 6]]
    description: Unsorted, no overlap

  - input: [[5, 6], [1, 3], [2, 4]]
    expected: [[1, 4], [5, 6]]
    description: Unsorted with overlap

  - input: [[4, 5], [1, 4], [0, 1]]
    expected: [[0, 5]]
    description: Unsorted, all merge into one

  # Multiple overlaps
  - input: [[1, 3], [2, 4], [3, 5], [4, 6]]
    expected: [[1, 6]]
    description: Chain of overlaps

  - input: [[1, 2], [3, 4], [5, 6], [7, 8]]
    expected: [[1, 2], [3, 4], [5, 6], [7, 8]]
    description: No overlaps

  # Tricky adjacent cases
  - input: [[1, 2], [2, 3], [3, 4]]
    expected: [[1, 4]]
    description: All adjacent, should merge

  - input: [[1, 2], [3, 4], [5, 6]]
    expected: [[1, 2], [3, 4], [5, 6]]
    description: Gaps, no merge

  # Large intervals
  - input: [[1, 100], [50, 60]]
    expected: [[1, 100]]
    description: Small inside large

  - input: [[1, 10], [5, 15], [12, 20]]
    expected: [[1, 20]]
    description: Overlapping chain

  # Negative numbers
  - input: [[-5, -1], [-3, 2], [3, 5]]
    expected: [[-5, 2], [3, 5]]
    description: Negative intervals

  - input: [[-10, -5], [-7, -3], [0, 5]]
    expected: [[-10, -3], [0, 5]]
    description: Negative with gap

  # Same start or end
  - input: [[1, 5], [1, 3]]
    expected: [[1, 5]]
    description: Same start

  - input: [[1, 5], [3, 5]]
    expected: [[1, 5]]
    description: Same end

  - input: [[1, 3], [1, 3]]
    expected: [[1, 3]]
    description: Identical intervals
